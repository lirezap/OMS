db {
    postgresql {
        // PostgreSQL JDBC url.
        url = "jdbc:postgresql://localhost:5432/oms"
        url = ${?DB_POSTGRESQL_URL}

        // Database username.
        username = "oms"
        username = ${?DB_POSTGRESQL_USERNAME}

        // Database password.
        password = "oms"
        password = ${?DB_POSTGRESQL_PASSWORD}

        // The name of the connections pool. Useful for debug or in logs.
        pool_name = "OMS Connection Pool"
        pool_name = ${?DB_POSTGRESQL_POOL_NAME}

        // The maximum number of connections in the pool.
        max_pool_size = 10
        max_pool_size = ${?DB_POSTGRESQL_MAX_POOL_SIZE}

        // The amount of time to wait for getting a connection from connections pool.
        connection_timeout = "10s"
        connection_timeout = ${?DB_POSTGRESQL_CONNECTION_TIMEOUT}

        // Connection keep alive time.
        keep_alive_time = "1m"
        keep_alive_time = ${?DB_POSTGRESQL_KEEP_ALIVE_TIME}

        // Maximum lifetime of a connection. After that, the connection should reset.
        max_life_time = "30m"
        max_life_time = ${?DB_POSTGRESQL_MAX_LIFE_TIME}

        // The amount of time to wait for a query to respond. If time passed, the cancel signal will be sent to the
        // database for that query.
        query_timeout = "5s"
        query_timeout = ${?DB_POSTGRESQL_QUERY_TIMEOUT}
    }
}

libraries {
    native {
        lz4 {
            // The shared object (or dynamic) LZ4 library path.
            path = ""
            path = ${?LIBRARIES_NATIVE_LZ4_PATH}
        }
    }
}

logging {
    messages {
        // Whether the file logging of all incoming messages should be enabled or not.
        enabled = true
        enabled = ${?LOGGING_MESSAGES_ENABLED}

        // The logging file path.
        file_path = "/tmp/oms.log"
        file_path = ${?LOGGING_MESSAGES_FILE_PATH}

        // The number of threads to log incoming messages with.
        parallelism = 2
        parallelism = ${?LOGGING_MESSAGES_PARALLELISM}
    }
}

executors {
    worker {
        // Should the virtual thread per task be enabled for worker executor or not?
        virtual_threads_enabled = false
        virtual_threads_enabled = ${?EXECUTORS_WORKER_VIRTUAL_THREADS_ENABLED}

        // The number of threads for worker executor.
        threads = 10
        threads = ${?EXECUTORS_WORKER_THREADS}
    }
}

matching {
    engine {
        // The initial size of order books.
        queues_initial_cap = 10000
        queues_initial_cap = ${?MATCHING_ENGINE_QUEUES_INITIAL_CAP}

        // The directory to store all OMS related files, something like PostgreSQL data directory.
        data_directory_path = "/tmp"
        data_directory_path = ${?MATCHING_ENGINE_DATA_DIRECTORY_PATH}

        // Whether to store orders into database or not. If false, duplicate requests must not be provided by request
        // caller.
        store_orders = false
        store_orders = ${?MATCHING_ENGINE_STORE_ORDERS}
    }
}

server {
    // TCP server host address to listen on.
    host = "localhost"
    host = ${?SERVER_HOST}

    // TCP server port number to listen on.
    port = 7178
    port = ${?SERVER_PORT}

    // The TCP option of the buffer size of receiving bytes. Increase this value when the size of incoming bytes are
    // very large to lower the round trip of buffer copying between connection and the application.
    receive_buffer_size = 1024
    receive_buffer_size = ${?SERVER_RECEIVE_BUFFER_SIZE}

    // The TCP option of reuse address. Let it be false for safety.
    reuse_address = false
    reuse_address = ${?SERVER_REUSE_ADDRESS}

    // The application level option of the buffer size. If incoming bytes of a message is more than this value, the
    // connection creates new buffer with previous size + read_buffer_size then copies bytes to the new one.
    read_buffer_size = 1024
    read_buffer_size = ${?SERVER_READ_BUFFER_SIZE}

    // The application level option of the maximum size of a message to be handled properly.
    max_message_size = 1048576
    max_message_size = ${?SERVER_MAX_MESSAGE_SIZE}
}
